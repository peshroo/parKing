$(function() {
  $('.user_partial').html("<%= escape_javascript(render partial: 'listings') %>");

  var toggles = document.querySelectorAll('.switch > input[type="checkbox"]')
  toggles.forEach(function(checkbox) {
    if (checkbox.checked) {
      checkbox.parentElement.parentElement.classList.remove('off')
    } else {
      checkbox.parentElement.parentElement.classList.remove('off')
      checkbox.parentElement.parentElement.classList.add('off')
    }
  })
//
//   var listingsDiv = document.querySelector('.userlistings_container')
//   listingsDiv.addEventListener('click', function(e) {
//     if ( listingsDiv && e.target.classList.contains('toggler')) {
//       if (e.target.checked === false) {
//
//       console.log(e.target.checked)
//       e.target.parentElement.parentElement.classList.toggle('off');
//       $.ajax({
//           url: '/listings/' + e.target.parentElement.firstElementChild.value,
//           method: 'PATCH',
//           data: {
//             no_turbolink: true,
//             listing: {
//               status: false
//             }
//           }
//       }).always(function(response) {
//           if (response.responseText === 'ok') {
//           console.log('sent false');
//         } else {
//           e.target.parentElement.parentElement.classList.toggle('off');
//           e.target.checked = true
//           alert("Request Failed")
//         }
//       });
//
//     } else {
//       e.target.parentElement.parentElement.classList.toggle('off')
//       $.ajax({
//           url: '/listings/' + e.target.parentElement.firstElementChild.value,
//           method: 'PATCH',
//           data: {
//             no_turbolink: true,
//             listing: {
//               status: true
//             }
//           }
//       }).always(function(response) {
//           if (response.responseText === 'ok') {
//           console.log('sent true')
//         } else {
//           e.target.parentElement.parentElement.classList.toggle('off')
//           e.target.checked = false
//           alert("Request Failed")
//         }
//       })
//     }
//   }
// })

});
